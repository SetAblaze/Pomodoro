{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/khalo/Desktop/Pomodoro_CanvasApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/khalo/Desktop/Pomodoro_CanvasApp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:/Users/khalo/Desktop/Pomodoro_CanvasApp/node_modules/@babel/runtime/regenerator/index.js\";import React,{FC,memo,useState,useReducer,useRef,useEffect}from\"react\";import'./App.css';import Timer from\"./Timer\";import Settings from\"./Settings\";import SettingsContext from\"./SettingsContext\";import{createSmartappDebugger,createAssistant,AssistantAppState}from\"@sberdevices/assistant-client\";import{jsx as _jsx}from\"react/jsx-runtime\";var initAssistant=function initAssistant(getState){if(process.env.NODE_ENV===\"development\"){var _process$env$REACT_AP;return createSmartappDebugger({token:(_process$env$REACT_AP=process.env.REACT_APP_TOKEN)!==null&&_process$env$REACT_AP!==void 0?_process$env$REACT_AP:\"\",initPhrase:\"\\u041E\\u0442\\u043A\\u0440\\u043E\\u0439 \\u041F\\u043E\\u043C\\u043E\\u0434\\u043E\\u0440\\u043E\",getState:getState});}return createAssistant({getState:getState});};function App(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showSettings=_useState2[0],setShowSettings=_useState2[1];var _useState3=useState(45),_useState4=_slicedToArray(_useState3,2),workMinutes=_useState4[0],setWorkMinutes=_useState4[1];var _useState5=useState(15),_useState6=_slicedToArray(_useState5,2),breakMinutes=_useState6[0],setBreakMinutes=_useState6[1];var _useReducer=useReducer(),_useReducer2=_slicedToArray(_useReducer,2),appState=_useReducer2[0],dispatch=_useReducer2[1];var assistantRef=useRef();var assistant=useRef(typeof createAssistant);var state={notes:[]};var getStateForAssistant=function getStateForAssistant(){console.log(\"getStateForAssistant: this.state:\",state);var state_={item_selector:{items:state.notes.map(function(_ref,index){var id=_ref.id,title=_ref.title;return{number:index+1,id:id,title:title};})}};console.log(\"getStateForAssistant: state:\",state);return state_;};useEffect(function(){assistant.current=initAssistant(function(){return getStateForAssistant();});assistant.current.on(\"start\",function(event){console.log(\"assistant.on(start)\",event);});assistant.current.on(\"data\",function(event/*: any*/){if(event.type==\"smart_app_data\"){console.log(event);if(event.sub!=undefined){console.log(\"Sub\",event.sub);}else if(event.user_id!=undefined){console.log(\"UserId\",event.user_id);}}console.log(\"assistant.on(data)\",event);var action=event.action;dispatchAssistantAction(action);});},[]);var dispatchAssistantAction=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(action){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(\"dispatchAssistantAction\",action);if(!action){_context.next=12;break;}_context.t0=action.type;_context.next=_context.t0===\"timerUp\"?5:_context.t0===\"timerDown\"?8:11;break;case 5:console.log(\"timerUp\");document.getElementById(\"playBtn\").click();return _context.abrupt(\"break\",12);case 8:console.log(\"timerDown\");document.getElementById(\"pauseBtn\").click();return _context.abrupt(\"break\",12);case 11:return _context.abrupt(\"break\",12);case 12:case\"end\":return _context.stop();}}},_callee);}));return function dispatchAssistantAction(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsx(SettingsContext.Provider,{value:{showSettings:showSettings,setShowSettings:setShowSettings,workMinutes:workMinutes,breakMinutes:breakMinutes,setWorkMinutes:setWorkMinutes,setBreakMinutes:setBreakMinutes},children:showSettings?/*#__PURE__*/_jsx(Settings,{}):/*#__PURE__*/_jsx(Timer,{})})});}export default App;","map":{"version":3,"names":["React","FC","memo","useState","useReducer","useRef","useEffect","Timer","Settings","SettingsContext","createSmartappDebugger","createAssistant","AssistantAppState","initAssistant","getState","process","env","NODE_ENV","token","REACT_APP_TOKEN","initPhrase","App","showSettings","setShowSettings","workMinutes","setWorkMinutes","breakMinutes","setBreakMinutes","appState","dispatch","assistantRef","assistant","state","notes","getStateForAssistant","console","log","state_","item_selector","items","map","index","id","title","number","current","on","event","type","sub","undefined","user_id","action","dispatchAssistantAction","document","getElementById","click"],"sources":["C:/Users/khalo/Desktop/Pomodoro_CanvasApp/src/App.js"],"sourcesContent":["import React, {\n  FC,\n  memo,\n  useState,\n  useReducer,\n  useRef,\n  useEffect\n} from \"react\";\nimport './App.css';\nimport Timer from \"./Timer\";\nimport Settings from \"./Settings\";\nimport SettingsContext from \"./SettingsContext\";\n\nimport {\n  createSmartappDebugger,\n  createAssistant,\n  AssistantAppState, \n} from \"@sberdevices/assistant-client\";\n\n\nconst initAssistant = (getState) => {\n  if (process.env.NODE_ENV === \"development\") {\n    return createSmartappDebugger({\n      token: process.env.REACT_APP_TOKEN ?? \"\",\n      initPhrase: `Открой Помодоро`,\n      getState\n    });\n  }\n  return createAssistant({ getState });\n};\n\n\nfunction App() {\n  const [showSettings, setShowSettings] = useState(false);\n  const [workMinutes, setWorkMinutes] = useState(45);\n  const [breakMinutes, setBreakMinutes] = useState(15);\n  const [appState, dispatch] = useReducer();\n\n  const assistantRef = useRef(); \n  const assistant = useRef(typeof createAssistant);\n\n  var state = {\n    notes: [],\n    };\n\n    const getStateForAssistant = () => {\n      console.log(\"getStateForAssistant: this.state:\", state);\n      const state_ = {\n      item_selector: {\n      items: state.notes.map(({ id, title }, index) => ({\n      number: index + 1,\n      id,\n      title,\n      })),\n      },\n      };\n      console.log(\"getStateForAssistant: state:\", state);\n      return state_;\n    };\n\n    useEffect(() => {\n      assistant.current = initAssistant(() => getStateForAssistant());\n      assistant.current.on(\"start\", (event) => {\n      console.log(`assistant.on(start)`, event);\n      });\n      assistant.current.on(\"data\", (event /*: any*/) => {\n        if (event.type == \"smart_app_data\") {\n          console.log(event);\n          if (event.sub != undefined) {\n            console.log(\"Sub\", event.sub);\n            \n          } else if (event.user_id != undefined) {\n            console.log(\"UserId\", event.user_id);\n          }\n        }\n        console.log(`assistant.on(data)`, event);\n        const { action } = event;\n\n        dispatchAssistantAction(action);\n        \n  });\n    },\n    []);\n\n\n    const dispatchAssistantAction = async (action) => {\n      console.log(\"dispatchAssistantAction\", action);\n      if (action) {\n        switch (action.type) {\n          case \"timerUp\":\n            console.log(\"timerUp\")\n            document.getElementById(\"playBtn\").click();\n            break;\n          case \"timerDown\":\n            console.log(\"timerDown\")\n            document.getElementById(\"pauseBtn\").click();\n            break;\n          default:\n            break;\n          }\n        }\n      };\n\n  return (\n    <main>\n      <SettingsContext.Provider value={{\n        showSettings,\n        setShowSettings,\n        workMinutes,\n        breakMinutes,\n        setWorkMinutes,\n        setBreakMinutes,\n      }}>\n        {showSettings ? <Settings /> : <Timer />}\n      </SettingsContext.Provider>\n    </main>\n  );\n}\n\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}